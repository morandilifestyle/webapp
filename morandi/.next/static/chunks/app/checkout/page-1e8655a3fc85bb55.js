(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{3841:function(e,s,r){Promise.resolve().then(r.bind(r,181))},9376:function(e,s,r){"use strict";var t=r(5475);r.o(t,"useParams")&&r.d(s,{useParams:function(){return t.useParams}}),r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(s,{useSearchParams:function(){return t.useSearchParams}})},181:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return b}});var t=r(7437),a=r(2265),n=r(8422),i=r(6676);let l=[{id:"cart",name:"Cart Review",description:"Review your items"},{id:"shipping",name:"Shipping",description:"Delivery information"},{id:"payment",name:"Payment",description:"Payment method"},{id:"confirmation",name:"Confirmation",description:"Order complete"}];function d(e){let{currentStep:s}=e,r=l.findIndex(e=>e.id===s);return(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("nav",{"aria-label":"Progress",children:(0,t.jsx)("ol",{className:"flex items-center",children:l.map((e,s)=>(0,t.jsxs)("li",{className:"relative ".concat(s!==l.length-1?"pr-8 sm:pr-20":""," flex-1"),children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:(0,t.jsx)("div",{className:"h-0.5 w-full ".concat(s<r?"bg-blue-600":"bg-gray-200")})}),(0,t.jsx)("div",{className:"relative flex h-8 w-8 items-center justify-center rounded-full ".concat(s<r?"bg-blue-600 hover:bg-blue-900":s===r?"bg-blue-600 ring-2 ring-blue-600 ring-offset-2":"bg-white border-2 border-gray-300 group-hover:border-gray-400"),children:s<r?(0,t.jsx)("svg",{className:"h-5 w-5 text-white",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,t.jsx)("span",{className:"text-sm font-medium ".concat(s===r?"text-blue-600":"text-gray-500"),children:s+1})}),(0,t.jsx)("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2",children:(0,t.jsx)("span",{className:"text-xs font-medium ".concat(s<=r?"text-blue-600":"text-gray-500"),children:e.name})})]},e.id))})})})}var o=r(3145),c=r(7648);function m(e){let{cart:s,onNext:r}=e,a=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Review Your Cart"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Please review your items before proceeding"})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("div",{className:"space-y-4",children:s.items.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-4 py-4 border-b border-gray-100 last:border-b-0",children:[(0,t.jsx)("div",{className:"relative w-16 h-16 flex-shrink-0",children:(0,t.jsx)(o.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover rounded-lg",sizes:"64px"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),e.attributes&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.attributes.material&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:e.attributes.material}),e.attributes.color&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:e.attributes.color}),e.attributes.size&&(0,t.jsx)("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded",children:e.attributes.size})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Qty: ",e.quantity]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a((e.salePrice||e.price)*e.quantity)}),e.salePrice&&(0,t.jsx)("p",{className:"text-xs text-gray-500 line-through",children:a(e.price*e.quantity)})]})]},e.id))}),(0,t.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{children:["Subtotal (",s.itemCount," items)"]}),(0,t.jsx)("span",{children:a(s.subtotal)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Tax (18% GST)"}),(0,t.jsx)("span",{children:a(s.tax)})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Shipping"}),(0,t.jsx)("span",{children:0===s.shipping?"Free":a(s.shipping)})]}),(0,t.jsx)("div",{className:"border-t pt-3",children:(0,t.jsxs)("div",{className:"flex justify-between text-lg font-semibold",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsx)("span",{children:a(s.total)})]})})]})}),(0,t.jsxs)("div",{className:"mt-6 flex justify-between",children:[(0,t.jsx)(c.default,{href:"/cart",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back to Cart"}),(0,t.jsx)("button",{onClick:r,className:"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Continue to Shipping"})]})]})]})}function u(e){let{onNext:s,onBack:r,initialData:n}=e,[i,l]=(0,a.useState)([]),[d,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(!0),[u,x]=(0,a.useState)(n.shipping_method_id),[h,p]=(0,a.useState)(n.shipping_address||{first_name:"",last_name:"",company:"",address_line_1:"",address_line_2:"",city:"",state:"",postal_code:"",country:"India",phone:""}),[g,b]=(0,a.useState)(n.billing_address||{first_name:"",last_name:"",company:"",address_line_1:"",address_line_2:"",city:"",state:"",postal_code:"",country:"India",phone:""});(0,a.useEffect)(()=>{f()},[]);let f=async()=>{try{let e=await fetch("/api/orders/shipping/methods"),s=await e.json();s.success&&(l(s.data),!u&&s.data.length>0&&x(s.data[0].id))}catch(e){console.error("Failed to fetch shipping methods:",e)}},y=(e,s)=>{p(r=>({...r,[e]:s})),c&&b(r=>({...r,[e]:s}))},j=(e,s)=>{b(r=>({...r,[e]:s}))},N=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Shipping Information"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Enter your delivery and billing information"})]}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!u){alert("Please select a shipping method");return}let r=["first_name","last_name","address_line_1","city","state","postal_code","phone"];for(let e of r)if(!h[e]){alert("Please fill in the ".concat(e.replace("_"," ")," field"));return}if(!c){for(let e of r)if(!g[e]){alert("Please fill in the billing ".concat(e.replace("_"," ")," field"));return}}s(h,c?h:g,u)},className:"p-6",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Shipping Method"}),(0,t.jsx)("div",{className:"space-y-3",children:i.map(e=>(0,t.jsxs)("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"radio",name:"shipping_method",value:e.id,checked:u===e.id,onChange:e=>x(e.target.value),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,t.jsxs)("div",{className:"ml-3 flex-1",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:N(e.base_rate)})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.description}),(0,t.jsxs)("p",{className:"text-xs text-gray-400",children:["Estimated delivery: ",e.estimated_days," days"]})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Shipping Address"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),(0,t.jsx)("input",{type:"text",value:h.first_name,onChange:e=>y("first_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),(0,t.jsx)("input",{type:"text",value:h.last_name,onChange:e=>y("last_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),(0,t.jsx)("input",{type:"text",value:h.company,onChange:e=>y("company",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone *"}),(0,t.jsx)("input",{type:"tel",value:h.phone,onChange:e=>y("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 1 *"}),(0,t.jsx)("input",{type:"text",value:h.address_line_1,onChange:e=>y("address_line_1",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 2"}),(0,t.jsx)("input",{type:"text",value:h.address_line_2,onChange:e=>y("address_line_2",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,t.jsx)("input",{type:"text",value:h.city,onChange:e=>y("city",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State *"}),(0,t.jsx)("input",{type:"text",value:h.state,onChange:e=>y("state",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code *"}),(0,t.jsx)("input",{type:"text",value:h.postal_code,onChange:e=>y("postal_code",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),(0,t.jsx)("input",{type:"text",value:h.country,onChange:e=>y("country",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center mb-4",children:[(0,t.jsx)("input",{type:"checkbox",id:"same_address",checked:c,onChange:e=>m(e.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"same_address",className:"ml-2 text-sm font-medium text-gray-700",children:"Use same address for billing"})]}),!c&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-4",children:"Billing Address"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),(0,t.jsx)("input",{type:"text",value:g.first_name,onChange:e=>j("first_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),(0,t.jsx)("input",{type:"text",value:g.last_name,onChange:e=>j("last_name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company"}),(0,t.jsx)("input",{type:"text",value:g.company,onChange:e=>j("company",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone *"}),(0,t.jsx)("input",{type:"tel",value:g.phone,onChange:e=>j("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 1 *"}),(0,t.jsx)("input",{type:"text",value:g.address_line_1,onChange:e=>j("address_line_1",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address Line 2"}),(0,t.jsx)("input",{type:"text",value:g.address_line_2,onChange:e=>j("address_line_2",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City *"}),(0,t.jsx)("input",{type:"text",value:g.city,onChange:e=>j("city",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State *"}),(0,t.jsx)("input",{type:"text",value:g.state,onChange:e=>j("state",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code *"}),(0,t.jsx)("input",{type:"text",value:g.postal_code,onChange:e=>j("postal_code",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!c})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),(0,t.jsx)("input",{type:"text",value:g.country,onChange:e=>j("country",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Back"}),(0,t.jsx)("button",{type:"submit",className:"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Continue to Payment"})]})]})]})}var x=r(257);function h(e){let{onNext:s,onBack:r,loading:n,error:i,orderData:l}=e,[d,o]=(0,a.useState)([]),[c,m]=(0,a.useState)(""),[u,h]=(0,a.useState)(null);(0,a.useEffect)(()=>{p(),g()},[]);let p=async()=>{try{let e=await fetch("/api/orders/payment/methods"),s=await e.json();s.success&&(o(s.data),s.data.length>0&&m(s.data[0].id))}catch(e){console.error("Failed to fetch payment methods:",e)}},g=async()=>{try{h({subtotal:2500,tax:450,shipping:100,total:3050})}catch(e){console.error("Failed to fetch order summary:",e)}},b=async e=>{if(e.preventDefault(),!c){alert("Please select a payment method");return}"razorpay"===c?await f():s(c)},f=async()=>{try{let e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e),e.onload=()=>{let e={key:x.env.NEXT_PUBLIC_RAZORPAY_KEY_ID,amount:100*((null==u?void 0:u.total)||0),currency:"INR",name:"Morandi Lifestyle",description:"Sustainable Textile Products",order_id:l.razorpay_order_id,handler:function(e){y(e)},prefill:{name:"".concat(l.shipping_address.first_name," ").concat(l.shipping_address.last_name),email:"customer@example.com",contact:l.shipping_address.phone},theme:{color:"#10B981"},modal:{ondismiss:function(){console.log("Payment modal closed")}}};new window.Razorpay(e).open()}}catch(e){console.error("Razorpay payment error:",e)}},y=async e=>{try{let r=await fetch("/api/orders/payment/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({razorpay_order_id:e.razorpay_order_id,razorpay_payment_id:e.razorpay_payment_id,razorpay_signature:e.razorpay_signature,order_id:l.order_id})}),t=await r.json();t.success?s("razorpay"):alert("Payment verification failed: "+t.error)}catch(e){console.error("Payment verification error:",e),alert("Payment verification failed")}},j=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(e);return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Payment Method"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Choose your preferred payment method"})]}),(0,t.jsxs)("form",{onSubmit:b,className:"p-6",children:[(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("div",{className:"space-y-3",children:d.map(e=>(0,t.jsxs)("label",{className:"flex items-center p-4 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,t.jsx)("input",{type:"radio",name:"payment_method",value:e.id,checked:c===e.id,onChange:e=>m(e.target.value),className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,t.jsx)("div",{className:"ml-3 flex-1",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"text-2xl mr-3",children:e.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})})]},e.id))})}),u&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("h3",{className:"text-md font-medium text-gray-900 mb-3",children:"Order Summary"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Subtotal"}),(0,t.jsx)("span",{children:j(u.subtotal)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Tax (18% GST)"}),(0,t.jsx)("span",{children:j(u.tax)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"Shipping"}),(0,t.jsx)("span",{children:j(u.shipping)})]}),(0,t.jsx)("div",{className:"border-t pt-2",children:(0,t.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsx)("span",{children:j(u.total)})]})})]})]}),i&&(0,t.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"ml-3",children:(0,t.jsx)("p",{className:"text-sm text-red-700",children:i})})]})}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("button",{type:"button",onClick:r,disabled:n,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50",children:"Back"}),(0,t.jsx)("button",{type:"submit",disabled:n||!c,className:"inline-flex items-center px-6 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Complete Order"})]})]})]})}function p(e){let{orderId:s,orderNumber:r}=e;return(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Order Confirmation"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Thank you for your order!"})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Order Placed Successfully!"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"Your order has been confirmed and we'll send you an email with tracking information."}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Order ID:"}),(0,t.jsx)("p",{className:"text-gray-900",children:s})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Order Number:"}),(0,t.jsx)("p",{className:"text-gray-900",children:r})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Status:"}),(0,t.jsx)("p",{className:"text-green-600 font-medium",children:"Confirmed"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-700",children:"Payment:"}),(0,t.jsx)("p",{className:"text-green-600 font-medium",children:"Paid"})]})]})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"What's Next?"}),(0,t.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:(0,t.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"1"})}),(0,t.jsx)("p",{children:"You'll receive an order confirmation email within a few minutes"})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:(0,t.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"2"})}),(0,t.jsx)("p",{children:"We'll process your order and ship it within 1-2 business days"})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-3 mt-0.5",children:(0,t.jsx)("span",{className:"text-xs font-medium text-blue-600",children:"3"})}),(0,t.jsx)("p",{children:"You'll receive tracking information once your order ships"})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,t.jsx)(c.default,{href:"/orders",className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"View Orders"}),(0,t.jsx)(c.default,{href:"/products",className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700",children:"Continue Shopping"})]}),(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600 text-center",children:["Need help? Contact our support team at"," ",(0,t.jsx)("a",{href:"mailto:support@morandi.com",className:"text-blue-600 hover:text-blue-700",children:"support@morandi.com"})," ","or call us at"," ",(0,t.jsx)("a",{href:"tel:+91-1800-123-4567",className:"text-blue-600 hover:text-blue-700",children:"+91-1800-123-4567"})]})})]})})]})}var g=r(9376);function b(){let{cart:e,refreshCart:s}=(0,n.j)(),r=(0,g.useRouter)(),[l,o]=(0,a.useState)({step:"cart",shipping_address:null,billing_address:null,shipping_method_id:"",payment_method:"",order_id:null,razorpay_order_id:null,loading:!1,error:null});(0,a.useEffect)(()=>{s()},[s]),(0,a.useEffect)(()=>{0!==e.items.length||e.isLoading||r.push("/cart")},[e.items.length,e.isLoading,r]);let c=()=>{let e=["cart","shipping","payment","confirmation"],s=e.indexOf(l.step);s<e.length-1&&o(r=>({...r,step:e[s+1],error:null}))},x=()=>{let e=["cart","shipping","payment","confirmation"],s=e.indexOf(l.step);s>0&&o(r=>({...r,step:e[s-1],error:null}))},b=(e,s,r)=>{o(t=>({...t,shipping_address:e,billing_address:s,shipping_method_id:r,step:"payment",error:null}))},f=async s=>{if(!l.shipping_address||!l.shipping_method_id){o(e=>({...e,error:"Please complete shipping information first"}));return}o(e=>({...e,payment_method:s,loading:!0,error:null}));try{let r=await fetch("/api/orders/checkout/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:e.items.map(e=>({product_id:e.productId,quantity:e.quantity,unit_price:e.salePrice||e.price,total_price:(e.salePrice||e.price)*e.quantity,attributes:e.attributes})),shipping_address:l.shipping_address,billing_address:l.billing_address,shipping_method_id:l.shipping_method_id,payment_method:s})}),t=await r.json();if(!r.ok)throw Error(t.error||"Checkout initialization failed");o(e=>({...e,order_id:t.data.order_id,razorpay_order_id:t.data.razorpay_order_id,step:"confirmation",loading:!1}))}catch(e){o(s=>({...s,error:e instanceof Error?e.message:"Checkout failed",loading:!1}))}};return e.isLoading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.default,{}),(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading checkout..."})]})})]}):0===e.items.length?null:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.default,{}),(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsx)(d,{currentStep:l.step}),(0,t.jsxs)("div",{className:"mt-8",children:[l.error&&(0,t.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,t.jsx)("div",{className:"ml-3",children:(0,t.jsx)("p",{className:"text-sm text-red-700",children:l.error})})]})}),(()=>{switch(l.step){case"cart":return(0,t.jsx)(m,{cart:e,onNext:c});case"shipping":return(0,t.jsx)(u,{onNext:b,onBack:x,initialData:{shipping_address:l.shipping_address,billing_address:l.billing_address,shipping_method_id:l.shipping_method_id}});case"payment":return(0,t.jsx)(h,{onNext:f,onBack:x,loading:l.loading,error:l.error,orderData:{order_id:l.order_id,razorpay_order_id:l.razorpay_order_id,shipping_address:l.shipping_address,billing_address:l.billing_address,shipping_method_id:l.shipping_method_id}});case"confirmation":return(0,t.jsx)(p,{orderId:l.order_id,orderNumber:l.razorpay_order_id});default:return null}})()]})]})})]})}}},function(e){e.O(0,[624,676,971,117,744],function(){return e(e.s=3841)}),_N_E=e.O()}]);