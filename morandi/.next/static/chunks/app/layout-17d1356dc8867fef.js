(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1934:function(t,e,r){Promise.resolve().then(r.t.bind(r,9974,23)),Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,8422))},257:function(t,e,r){"use strict";var a,o;t.exports=(null==(a=r.g.process)?void 0:a.env)&&"object"==typeof(null==(o=r.g.process)?void 0:o.env)?r.g.process:r(4227)},4227:function(t){!function(){var e={229:function(t){var e,r,a,o=t.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===n||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(r){try{return e.call(null,t,0)}catch(r){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:n}catch(t){e=n}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(t){r=i}}();var c=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&p())}function p(){if(!l){var t=s(d);l=!0;for(var e=c.length;e;){for(a=c,c=[];++u<e;)a&&a[u].run();u=-1,e=c.length}a=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function y(t,e){this.fun=t,this.array=e}function m(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new y(t,e)),1!==c.length||l||s(p)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},r={};function a(t){var o=r[t];if(void 0!==o)return o.exports;var n=r[t]={exports:{}},i=!0;try{e[t](n,n.exports,a),i=!1}finally{i&&delete r[t]}return n.exports}a.ab="//";var o=a(229);t.exports=o}()},8422:function(t,e,r){"use strict";r.d(e,{CartProvider:function(){return d},j:function(){return p}});var a=r(7437),o=r(2265);let n=r(257).env.NEXT_PUBLIC_API_URL||"http://localhost:3001/api";class i{async request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="".concat(n).concat(t),a={headers:{"Content-Type":"application/json",...e.headers},credentials:"include",...e};try{let t=await fetch(r,a);if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.message||"HTTP error! status: ".concat(t.status))}return await t.json()}catch(t){throw console.error("Cart API error:",t),t}}async getCart(){return this.request("/cart")}async getCartCount(){return this.request("/cart/count")}async addToCart(t){return this.request("/cart/items",{method:"POST",body:JSON.stringify(t)})}async updateCartItem(t,e){return this.request("/cart/items/".concat(t),{method:"PUT",body:JSON.stringify(e)})}async removeCartItem(t){return this.request("/cart/items/".concat(t),{method:"DELETE"})}async clearCart(){return this.request("/cart/clear",{method:"POST"})}async mergeGuestCart(){return this.request("/cart/merge",{method:"POST"})}}let s=new i,c={items:[],subtotal:0,tax:0,shipping:0,total:0,itemCount:0,isLoading:!1,error:null};function l(t,e){switch(e.type){case"SET_LOADING":return{...t,isLoading:e.payload};case"SET_ERROR":return{...t,error:e.payload};case"SET_CART":return{...t,items:e.payload.items||[],subtotal:e.payload.subtotal||0,tax:e.payload.tax||0,shipping:e.payload.shipping||0,total:e.payload.total||0,itemCount:e.payload.itemCount||0,error:null};case"ADD_ITEM":let r=t.items.findIndex(t=>t.productId===e.payload.productId);if(!(r>=0))return{...t,items:[...t.items,e.payload]};{let a=[...t.items];return a[r]={...a[r],quantity:a[r].quantity+e.payload.quantity},{...t,items:a}}case"UPDATE_ITEM":return{...t,items:t.items.map(t=>t.id===e.payload.id?{...t,quantity:e.payload.quantity}:t)};case"REMOVE_ITEM":return{...t,items:t.items.filter(t=>t.id!==e.payload)};case"CLEAR_CART":return{...c};default:return t}}let u=(0,o.createContext)(void 0);function d(t){let{children:e}=t,[r,n]=(0,o.useReducer)(l,c);(0,o.useEffect)(()=>{i()},[]),(0,o.useEffect)(()=>{let t=r.items.reduce((t,e)=>t+(e.salePrice||e.price)*e.quantity,0),e=.08*t,a=t>50?0:5.99,o=r.items.reduce((t,e)=>t+e.quantity,0);n({type:"SET_CART",payload:{items:r.items,subtotal:t,tax:e,shipping:a,total:t+e+a,itemCount:o}})},[r.items]);let i=async()=>{try{n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null});let t=await s.getCart(),e=t.items.map(t=>{var e;return{id:t.id,productId:t.product_id,name:t.product.name,price:t.product.price,salePrice:t.product.sale_price,quantity:t.quantity,image:(null===(e=t.product.images)||void 0===e?void 0:e[0])||"/images/placeholder-product.jpg",stock:t.product.stock_quantity,maxQuantity:Math.min(99,t.product.stock_quantity),slug:t.product.slug,attributes:t.product.attributes}});n({type:"SET_CART",payload:{items:e,subtotal:t.subtotal,tax:t.tax,shipping:t.shipping,total:t.total,itemCount:t.itemCount}})}catch(t){console.error("Failed to refresh cart:",t),n({type:"SET_ERROR",payload:"Failed to load cart"})}finally{n({type:"SET_LOADING",payload:!1})}},d=async(t,e)=>{try{if(n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null}),e>t.stock_quantity)throw Error("Requested quantity exceeds available stock");await s.addToCart({productId:t.id,quantity:e}),await i()}catch(t){throw console.error("Failed to add item to cart:",t),n({type:"SET_ERROR",payload:t instanceof Error?t.message:"Failed to add item to cart"}),t}finally{n({type:"SET_LOADING",payload:!1})}},p=async(t,e)=>{try{if(n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null}),e<=0){await y(t);return}await s.updateCartItem(t,{quantity:e}),await i()}catch(t){throw console.error("Failed to update cart item:",t),n({type:"SET_ERROR",payload:t instanceof Error?t.message:"Failed to update item quantity"}),t}finally{n({type:"SET_LOADING",payload:!1})}},y=async t=>{try{n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null}),await s.removeCartItem(t),await i()}catch(t){throw console.error("Failed to remove cart item:",t),n({type:"SET_ERROR",payload:t instanceof Error?t.message:"Failed to remove item from cart"}),t}finally{n({type:"SET_LOADING",payload:!1})}},m=async()=>{try{n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null}),await s.clearCart(),n({type:"CLEAR_CART"})}catch(t){throw console.error("Failed to clear cart:",t),n({type:"SET_ERROR",payload:t instanceof Error?t.message:"Failed to clear cart"}),t}finally{n({type:"SET_LOADING",payload:!1})}},f=async()=>{try{n({type:"SET_LOADING",payload:!0}),n({type:"SET_ERROR",payload:null}),await s.mergeGuestCart(),await i()}catch(t){throw console.error("Failed to merge guest cart:",t),n({type:"SET_ERROR",payload:t instanceof Error?t.message:"Failed to merge guest cart"}),t}finally{n({type:"SET_LOADING",payload:!1})}};return(0,a.jsx)(u.Provider,{value:{cart:r,addItem:d,updateQuantity:p,removeItem:y,clearCart:m,mergeGuestCart:f,refreshCart:i},children:e})}function p(){let t=(0,o.useContext)(u);if(void 0===t)throw Error("useCart must be used within a CartProvider");return t}},2778:function(){},9974:function(t){t.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(t){t.O(0,[635,971,117,744],function(){return t(t.s=1934)}),_N_E=t.O()}]);